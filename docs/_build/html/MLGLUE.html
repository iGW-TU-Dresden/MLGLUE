<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MLGLUE package &mdash; MLGLUE 0.0.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=282f96c0"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="MLGLUE" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MLGLUE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">MLGLUE</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">MLGLUE package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-MLGLUE.Likelihoods">MLGLUE.Likelihoods module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#MLGLUE.Likelihoods.GaussianLogLikelihood"><code class="docutils literal notranslate"><span class="pre">GaussianLogLikelihood</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MLGLUE.Likelihoods.InverseErrorVarianceLikelihood"><code class="docutils literal notranslate"><span class="pre">InverseErrorVarianceLikelihood</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#MLGLUE.Likelihoods.RelativeVarianceLikelihood"><code class="docutils literal notranslate"><span class="pre">RelativeVarianceLikelihood</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-MLGLUE.MLGLUE">MLGLUE.MLGLUE module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#MLGLUE.MLGLUE.MLGLUE"><code class="docutils literal notranslate"><span class="pre">MLGLUE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-MLGLUE">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MLGLUE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">MLGLUE</a></li>
      <li class="breadcrumb-item active">MLGLUE package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/MLGLUE.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mlglue-package">
<h1>MLGLUE package<a class="headerlink" href="#mlglue-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-MLGLUE.Likelihoods">
<span id="mlglue-likelihoods-module"></span><h2>MLGLUE.Likelihoods module<a class="headerlink" href="#module-MLGLUE.Likelihoods" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MLGLUE.Likelihoods.GaussianLogLikelihood">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MLGLUE.Likelihoods.</span></span><span class="sig-name descname"><span class="pre">GaussianLogLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/Likelihoods.html#GaussianLogLikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.Likelihoods.GaussianLogLikelihood" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.Likelihoods.GaussianLogLikelihood.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/Likelihoods.html#GaussianLogLikelihood.likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.Likelihoods.GaussianLogLikelihood.likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the Gaussian log-likelihood</p>
<p>Compute the Gaussian log-likelihood:</p>
<div class="math notranslate nohighlight">
\[L(\theta | Y) = - \frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\sigma^2) - \frac{1}{2}\sigma^{-2} \times \sum_{i=1}^n (y'_i(\theta) - y_i)^2\]</div>
<p>where <span class="math notranslate nohighlight">\(L(\cdot)\)</span> is the log-likelihood function,
<span class="math notranslate nohighlight">\(\theta\)</span> are model parameters, <span class="math notranslate nohighlight">\(y_i\)</span> are observations,
<span class="math notranslate nohighlight">\(\sigma^2\)</span> is the (theoretical) variance of errors or residuals,
<span class="math notranslate nohighlight">\(y'_i(\cdot)\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th model output corresponding
to the <span class="math notranslate nohighlight">\(i\)</span>-th observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>1D array-like</em><em> of </em><em>float</em>) – The observations of the system.</p></li>
<li><p><strong>sim</strong> (<em>1D array-like</em><em> of </em><em>float</em>) – The simulated observation equivalents, simulated by the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>likelihood</strong> – The likelihood computed from observations and simulated
observation equivalents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MLGLUE.Likelihoods.InverseErrorVarianceLikelihood">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MLGLUE.Likelihoods.</span></span><span class="sig-name descname"><span class="pre">InverseErrorVarianceLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/Likelihoods.html#InverseErrorVarianceLikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.Likelihoods.InverseErrorVarianceLikelihood" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.Likelihoods.InverseErrorVarianceLikelihood.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/Likelihoods.html#InverseErrorVarianceLikelihood.likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.Likelihoods.InverseErrorVarianceLikelihood.likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the Inverse Variance Likelihood</p>
<p>Compute the Inverse Variance Likelihood:</p>
<div class="math notranslate nohighlight">
\[L(\theta|Y) = (\sigma_e^2)^{-T}\]</div>
<p>where <span class="math notranslate nohighlight">\(L(\cdot)\)</span> is the likelihood function,
<span class="math notranslate nohighlight">\(\theta\)</span> are model parameters, <span class="math notranslate nohighlight">\(Y\)</span> are observations,
<span class="math notranslate nohighlight">\(\sigma_e^2\)</span> is the error or residual variance, and
<span class="math notranslate nohighlight">\(T\)</span> is the shape parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>1D array-like</em><em> of </em><em>float</em>) – The observations of the system.</p></li>
<li><p><strong>sim</strong> (<em>1D array-like</em><em> of </em><em>float</em>) – The simulated observation equivalents, simulated by the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>likelihood</strong> – The likelihood computed from observations and simulated
observation equivalents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MLGLUE.Likelihoods.RelativeVarianceLikelihood">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MLGLUE.Likelihoods.</span></span><span class="sig-name descname"><span class="pre">RelativeVarianceLikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/Likelihoods.html#RelativeVarianceLikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.Likelihoods.RelativeVarianceLikelihood" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.Likelihoods.RelativeVarianceLikelihood.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/Likelihoods.html#RelativeVarianceLikelihood.likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.Likelihoods.RelativeVarianceLikelihood.likelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the Relative Variance Likelihood</p>
<p>Compute the Relative Variance Likelihood:</p>
<div class="math notranslate nohighlight">
\[L(\theta | Y) = 1 - \frac{\sigma_e^2}{\sigma_{obs}^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(L(\cdot)\)</span> is the likelihood function,
<span class="math notranslate nohighlight">\(\theta\)</span> are model parameters, <span class="math notranslate nohighlight">\(Y\)</span> are observations,
<span class="math notranslate nohighlight">\(\sigma_e^2\)</span> is the variance of errors or residuals, and
<span class="math notranslate nohighlight">\(\sigma_{obs}^2\)</span> is the variance of observed values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>1D array-like</em><em> of </em><em>float</em>) – The observations of the system.</p></li>
<li><p><strong>sim</strong> (<em>1D array-like</em><em> of </em><em>float</em>) – The simulated observation equivalents, simulated by the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>likelihood</strong> – The likelihood computed from observations and simulated
observation equivalents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-MLGLUE.MLGLUE">
<span id="mlglue-mlglue-module"></span><h2>MLGLUE.MLGLUE module<a class="headerlink" href="#module-MLGLUE.MLGLUE" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MLGLUE.MLGLUE.</span></span><span class="sig-name descname"><span class="pre">MLGLUE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tuning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarsening_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiprocessing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hierarchy_analysis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'my_model'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.MLGLUE_sampling">
<span class="sig-name descname"><span class="pre">MLGLUE_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.MLGLUE_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.MLGLUE_sampling" title="Link to this definition"></a></dt>
<dd><p>Single-core MLGLUE sampling phase.</p>
<p>Perform the sampling phase of MLGLUE without using multiprocessing
/ Ray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>2D list-like</em><em> of </em><em>float</em>) – The parameter samples with which to perform sampling. Has to
have the individual samples as rows and variables / model
parameters as columns.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is implemented as an instance method; it cannot be used
independently of an MLGLUE instance. Therefore, results are not
returned by this function but are rather stored in the class /
instance attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.MLGLUE_tuning">
<span class="sig-name descname"><span class="pre">MLGLUE_tuning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.MLGLUE_tuning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.MLGLUE_tuning" title="Link to this definition"></a></dt>
<dd><p>Single-core MLGLUE tuning phase.</p>
<p>Perform the tuning phase of MLGLUE without using multiprocessing /
Ray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>2D list-like</em><em> of </em><em>float</em>) – The parameter samples with which to perform tuning. Has to have
the individual samples as rows and variables / model parameters
as columns.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is implemented as an instance method; it cannot be used
independently of an MLGLUE instance. Therefore, results are not
returned by this function but are rather stored in the class /
instance attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.analyze_means_likelihoods">
<span class="sig-name descname"><span class="pre">analyze_means_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.analyze_means_likelihoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.analyze_means_likelihoods" title="Link to this definition"></a></dt>
<dd><p>Analyze likelihood mean values.</p>
<p>Analyze the relationships between levels in terms of mean values:
(1) mean values of likelihood values on each individual level (2)
mean values of the difference between likelihood values on
subsequent levels.</p>
<p>Specifically, the following expression is evaluated for all levels:
.. math:: E[L_{ell}-L_{ell-1}]=E[L_{ell}]-E[L_{ell-1}]</p>
<p>where <span class="math notranslate nohighlight">\(L_{\ell}\)</span> is the random variable representing
likelihood values on level <span class="math notranslate nohighlight">\(\ell\)</span> form the tuning phase.
Then, for <span class="math notranslate nohighlight">\(E[L_{\ell}-L_{\ell-1}]\)</span> to decay
monotonically, the difference in the mean values of the likelihoods
on different levels has to decay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raise_error</strong> (<em>bool</em>) – Whether mean value analysis is strict or not. If not strict
(False), results of mean value analysis are printed to the
screen but MLGLUE continues independently of the result. If
strict (True), results are also printed to the screen but
MLGLUE is stopped if the mean values of the difference between
likelihood values on levels (l-1, l) are larger than on level
(l) and / or if the mean values of the difference between
likelihood values do not decay monotonically.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.analyze_variances_likelihoods">
<span class="sig-name descname"><span class="pre">analyze_variances_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raise_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.analyze_variances_likelihoods"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.analyze_variances_likelihoods" title="Link to this definition"></a></dt>
<dd><p>Analyze likelihood variances.</p>
<p>Analyze the relationships between levels in terms of variances:
(1) variances of likelihood values on each individual level (2)
covariances of likelihoods across levels (3) variances of the
difference between likelihood values on subsequent levels.</p>
<p>Specifically, the following expression is evaluated for all levels:
.. math:: Var[L_{ell}-L_{ell-1}]=Var[L_{ell}]+Var[L_{ell-1}]-2Cov[L_{ell}-L_{ell-1}]</p>
<p>where <span class="math notranslate nohighlight">\(L_{\ell}\)</span> is the random variable representing
likelihood values on level <span class="math notranslate nohighlight">\(\ell\)</span> form the tuning phase.
Then, for <span class="math notranslate nohighlight">\(Var[L_{\ell}-L_{\ell-1}]\)</span> to decay
monotonically, <span class="math notranslate nohighlight">\(2Cov[L_{\ell}-L_{\ell-1}]\)</span> has to be
larger than <span class="math notranslate nohighlight">\(Var[L_{\ell-1}]\)</span>, which implies that two
subsequent levels need to be sufficiently correlated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raise_error</strong> (<em>bool</em>) – Whether variance analysis is strict or not. If not strict
(False), results of variance analysis are printed to the screen
but MLGLUE continues independently of the result. If strict
(True), results are also printed to the screen but MLGLUE is
stopped if the variances between levels (l-1, l) is larger than
on level (l) and / or if the variances between levels do not
decay monotonically.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.calculate_thresholds">
<span class="sig-name descname"><span class="pre">calculate_thresholds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.calculate_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.calculate_thresholds" title="Link to this definition"></a></dt>
<dd><p>Calculate likelihood thresholds</p>
<p>Calculate the thresholds according to the threshold fraction given
by the user as a class attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.check_samples">
<span class="sig-name descname"><span class="pre">check_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.check_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.check_samples" title="Link to this definition"></a></dt>
<dd><p>Check user-specified parameter samples.</p>
<p>Check the user-specified parameter samples. If a tuple is given,
assign the elements to the respective attributes. If a single 2D
array-like is given, split it into tuning and sampling parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.estimate_uncertainty">
<span class="sig-name descname"><span class="pre">estimate_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.5,</span> <span class="pre">0.99]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.estimate_uncertainty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.estimate_uncertainty" title="Link to this definition"></a></dt>
<dd><p>Estimate simulation uncertainty.</p>
<p>Estimate the simulation uncertainty, i.e., normalize likelihoods,
and create probability densities for the model output. From that,
uncertainty estimates given by user-defined quantiles are computed.
The estimates are obtained by (1) normalizing likelihood values for
individual values to always be in the range [0, 1], (2) ordering
model outputs according to their associated normalized likelihood
value, (3) estimating CDFs for the model outputs, and (4) computing
quantile estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quantiles</strong> (<em>1D list-like</em><em> of </em><em>float</em>) – The quantiles with which to estimate the uncertainty of model
outputs. Quantiles have to be given as floats in the range
(0, 1). Default is [0.01, 0.50, 0.99].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>uncertainty</strong> – The uncertainty estimates where individual model outputs are in
rows and quantiles are in columns (in the order corresponding
to the given quantiles).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D list-like of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.evaluate_sample">
<span class="sig-name descname"><span class="pre">evaluate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.evaluate_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.evaluate_sample" title="Link to this definition"></a></dt>
<dd><p>Multiprocessing MLGLUE sampling utility.</p>
<p>Evaluate a single parameter sample with the MLGLUE hierarchy. This
design allows for multiprocessing (using Ray).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>1D list-like</em><em> of </em><em>float</em>) – The parameter sample which is evaluated. Each element has to
represent an individual model parameter. Note that the order of
the elements has to correspond to the order of model parameters
in the model callable.</p></li>
<li><p><strong>run_id</strong> (<em>int</em><em> or </em><em>str</em>) – A run identifier in the form of an integer or string (the value
of run_id is converted to a str later in any case). The value
of run_id is also passed to the model callable, which is
especially relevant if each model run is associated with a
corresponding individual working directory. Then this directory
can be named including the run_id value. This resolves problems
for multiprocessing when multiple such individual directories
are present in the same parent directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sample</strong> (<em>1D list-like of float</em>) – The parameter sample which was evaluated.</p></li>
<li><p><strong>likelihood_</strong> (<em>float</em>) – The likelihood value on the highest level corresponding to the
parameter sample which was evaluated.</p></li>
<li><p><strong>results</strong> (<em>1D list-like of float</em>) – The simulation results (at least all simulated observation
equivalents) on the highest level corresponding to the sample
which was evaluated.</p></li>
<li><p><strong>results_analysis_sample</strong> (<em>2D list-like of float</em>) – The simulation results (at least all simulated observation
equivalents) on all levels corresponding to the sample which
was evaluated. Has the levels in rows and the individual
results in columns.</p></li>
<li><p><strong>highest_level_call</strong> (<em>int</em>) – An identifier if the highest level model has been called (1) or
not (0) using the evaluated parameter sample. It may happen
that a parameter sample reaches the highest level model but is
not accepted after running the model with that sample. Such
cases should be minimized for MLGLUE to have optimal
efficiency.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All returns are returned together as a tuple.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.evaluate_sample_tuning">
<span class="sig-name descname"><span class="pre">evaluate_sample_tuning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.evaluate_sample_tuning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.evaluate_sample_tuning" title="Link to this definition"></a></dt>
<dd><p>Multiprocessing MLGLUE tuning utility.</p>
<p>Evaluate a single parameter sample for tuning with the MLGLUE
hierarchy. This design allows for multiprocessing (using Ray).
Although similar to the evaluate_sample method, this method is
slightly different: independently of the actual likelihood value,
the sample is passed through all levels in the model hierarchy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>1D list-like</em><em> of </em><em>float</em>) – The parameter sample which is evaluated. Each element has to
represent an individual model parameter. Note that the order of
the elements has to correspond to the order of model parameters
in the model callable.</p></li>
<li><p><strong>run_id</strong> (<em>int</em><em> or </em><em>str</em>) – A run identifier in the form of an integer or string (the value
of run_id is converted to a str later in any case). The value
of run_id is also passed to the model callable, which is
especially relevant if each model run is associated with a
corresponding individual working directory. Then this directory
can be named including the run_id value. This resolves problems
for multiprocessing when multiple such individual directories
are present in the same parent directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>likelihoods_sample</strong> (<em>1D list-like of float</em>) – The likelihood values on all levels corresponding to the
parameter sample (except for tuning samples that result in an
error or NaN returned by the model callable). The order is from
the lowest to the highest level.</p></li>
<li><p><strong>results_analysis_tuning_sample</strong> (<em>2D list-like of float</em>) – Holds simulated observation equivalents (ans possibly other
quantities returned by the model) corresponding to the tuning
sample (except for tuning samples that result in an error or
NaN returned by the model callable) on all levels;
has the tuning samples in the first dimension, the levels in
the second dimension, and the simulated values in the third
dimension.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.get_uniform_samples">
<span class="sig-name descname"><span class="pre">get_uniform_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.get_uniform_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.get_uniform_samples" title="Link to this definition"></a></dt>
<dd><p>Get uniform parameter samples.</p>
<p>Get uniform parameter samples in case no user-defined samples are
provided. The user-defined upper and lower bounds of the parameter
vector are used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE">
<span class="sig-name descname"><span class="pre">perform_MLGLUE</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.perform_MLGLUE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE" title="Link to this definition"></a></dt>
<dd><p>Perform the full MLGLUE algorithm.</p>
<p>Perform the full MLGLUE algorithm using single-core or parallelized
computation. Settings for performing all computations are obtained
from instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>selected_samples</strong> (<em>2D array-like of float</em>) – The array of selected samples that are accepted on the highest
level; has individual samples as rows and variables / model
parameters as columns.</p></li>
<li><p><strong>likelihoods</strong> (<em>1D array-like of float</em>) – The likelihood values correpsonding to the selected samples.</p></li>
<li><p><strong>results</strong> (<em>2D array-like of float</em>) – Holds simulated observation equivalents corresponding to all
posterior samples; has shape (len(selected_samples), len(obs)).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The returns of this function can always be accessed by referring to
the correpsonding instance attributes. This function only returns
those instance attributes for convenience.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_multiprocessing_sampling">
<span class="sig-name descname"><span class="pre">perform_MLGLUE_multiprocessing_sampling</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.perform_MLGLUE_multiprocessing_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_multiprocessing_sampling" title="Link to this definition"></a></dt>
<dd><p>MLGLUE sampling using multiprocessing.</p>
<p>Perform the MLGLUE sampling using multiprocessing / Ray. This only
includes actual computations and not the preparation of samples
etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_multiprocessing_tuning">
<span class="sig-name descname"><span class="pre">perform_MLGLUE_multiprocessing_tuning</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.perform_MLGLUE_multiprocessing_tuning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_multiprocessing_tuning" title="Link to this definition"></a></dt>
<dd><p>MLGLUE tuning using multiprocessing.</p>
<p>Perform the MLGLUE tuning using multiprocessing / Ray. This only
includes actual computations and not the preparation of samples
etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_singlecore_sampling">
<span class="sig-name descname"><span class="pre">perform_MLGLUE_singlecore_sampling</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.perform_MLGLUE_singlecore_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_singlecore_sampling" title="Link to this definition"></a></dt>
<dd><p>MLGLUE sampling using a single CPU.</p>
<p>Perform the MLGLUE sampling using a single CPU. This only includes
actual computations and not the preparation of samples etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_singlecore_tuning">
<span class="sig-name descname"><span class="pre">perform_MLGLUE_singlecore_tuning</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/MLGLUE/MLGLUE.html#MLGLUE.perform_MLGLUE_singlecore_tuning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MLGLUE.MLGLUE.MLGLUE.perform_MLGLUE_singlecore_tuning" title="Link to this definition"></a></dt>
<dd><p>MLGLUE tuning using a single CPU.</p>
<p>Perform the MLGLUE tuning using a single CPU. This only includes
actual computations and not the preparation of samples etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-MLGLUE">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-MLGLUE" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="MLGLUE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Max Rudolph.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>